*{box-sizing:border-box}
:root{ --bg:#0b0c0f; --panel:#111318; --card:#151821; --muted:#8a93a6; --text:#e5e7ef; --accent:#53d769; --border:#232633; }
html,body{height:100%}
body{ margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji; color:var(--text); background:var(--bg) }
.topbar{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--border); background:linear-gradient(180deg, #0b0c10, #0b0c0f); position:sticky; top:0; z-index:20 }
.topbar .brand h1{margin:0; font-size:20px}
.topbar .brand .subtle{margin:4px 0 0; color:var(--muted); font-size:13px}
.legend{display:flex; align-items:center; gap:8px; color:var(--muted); font-size:12px}
.legend .gradient{ width:180px; height:10px; border-radius:999px; border:1px solid var(--border); background: linear-gradient(90deg, #2ecc71, #e67e22, #e74c3c) }

.layout{display:grid; grid-template-columns: 340px 1fr; grid-template-areas: 'controls viz'; min-height: calc(100vh - 64px)}
.controls{ grid-area: controls; padding:16px; border-right:1px solid var(--border); background:var(--panel); overflow:auto; height: calc(100vh - 64px) }
.viz{ grid-area: viz; display:flex; flex-direction:column; min-width:0 }
#map{ height:55vh; width:100% }
.list{ flex:1; overflow:auto; margin:16px }

.card{ background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; margin:16px; box-shadow: 0 10px 20px rgba(0,0,0,0.25) }
.controls .card{ margin:0 0 16px 0 }
.card h2{ margin:0 0 12px 0; font-size:16px }

.control-block{margin:12px 0}
.control-block label{display:block; margin:0 0 6px 0; color:#c7cce0; font-weight:600; font-size:13px}
.chips{display:flex; flex-wrap:wrap; gap:8px}
.chips label{ background:#1b1f2b; border:1px solid var(--border); padding:6px 8px; border-radius:10px; font-size:12px }
.range-vals{display:flex; align-items:center; gap:8px; margin-top:8px}
.range-vals input{ width:100%; background:#0d0f14; border:1px solid var(--border); color:var(--text); padding:6px 8px; border-radius:8px }
.control-flex{display:flex; gap:12px; flex-wrap:wrap}
.control-flex .control-block{ flex:1 1 180px; min-width:180px }
.controls select, .controls input[type="number"]{ width:100%; box-sizing:border-box; background:#0d0f14; border:1px solid var(--border); color:var(--text); border-radius:8px; padding:8px }
.control-actions{display:flex; gap:8px; margin-top:8px}
button{ background:#202739; color:#e5e7ef; border:1px solid var(--border); padding:8px 10px; border-radius:10px; cursor:pointer }
button:hover{filter:brightness(1.08)}

#cards{ display:grid; grid-template-columns: 1fr; gap:12px }
.card-item{ border:1px solid var(--border); border-radius:12px; padding:12px; background:#131724 }
.card-item header{ display:flex; align-items:baseline; justify-content:space-between; margin-bottom:6px }
.card-item .title{ font-weight:700; font-size:16px }
.card-item .suburbs{ color:var(--muted); font-size:12px; margin-bottom:4px }
.kv{ display:grid; grid-template-columns: 1fr 1fr; gap:8px; font-size:13px }
.kv div{ display:flex; align-items:center; gap:6px }
.badge{ font-size:11px; color:#9fb0ff; border:1px solid #2b3550; background:#161c2c; padding:2px 6px; border-radius:999px }
.types{ display:flex; flex-wrap:wrap; gap:6px; margin-top:6px }
.types .badge{ color:#b2f1c5; border-color:#2a4736; background:#0f1e15 }

.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; color:#c7cce0}
footer{ color:var(--muted); font-size:12px; text-align:center; padding:12px }
.linklike{ background:none; border:none; color:#9fb0ff; text-decoration:underline; cursor:pointer; font: inherit; padding:0 }
.linklike:hover{ filter:brightness(1.1) }
.sep{ opacity:0.6; margin: 0 6px }

/* Map */
.leaflet-container { background:#0d0f14; border-bottom:1px solid var(--border) }
.leaflet-control-attribution{ display:block !important; font-size:11px; background: rgba(10,12,16,0.65); color:#c7cce0; border:1px solid var(--border); border-radius:8px; padding:3px 6px; backdrop-filter: blur(3px); }
.leaflet-control-attribution a{ color:#9fb0ff; }

/* Sort card prominence */
.sort-card{ position: sticky; top: 8px; z-index: 10 }

/* Slider improvements so tooltips don't cover inputs */
.control-block .noUi-target{ margin:10px 0 28px; } /* extra space for tooltips */
.noUi-tooltip{
  display:none; /* show only on hover/drag */
  background:#0d0f14;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:6px;
  padding:2px 6px;
  font-size:11px;
  white-space:nowrap;
  transform: translateY(-6px);
}
.noUi-handle:hover .noUi-tooltip,
.noUi-active .noUi-tooltip{ display:block; }

/* Modal */
.modal{ position: fixed; inset:0; display:none; z-index: 1000 }
.modal.show{ display:block }
.modal-backdrop{ position:absolute; inset:0; background: rgba(0,0,0,0.55); backdrop-filter: blur(2px); }
.modal-dialog{ position:relative; background:#151821; color:#e5e7ef; border:1px solid var(--border); border-radius: 14px; width:min(780px, 92vw); margin: 8vh auto 0; box-shadow: 0 18px 48px rgba(0,0,0,0.45); }
.modal-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--border) }
.modal-head h3{ margin:0; font-size:18px }
.modal-body{ padding:14px; line-height:1.45 }
.modal-body ul{ margin:6px 0 10px 18px }
.modal-foot{ display:flex; justify-content:flex-end; gap:8px; padding:12px 14px; border-top:1px solid var(--border) }
.modal .close{ background:#202739; color:#e5e7ef; border:1px solid var(--border); padding:6px 10px; border-radius:10px; cursor:pointer; }
.modal .close.primary{ background:#29406a }

@media (max-width: 960px){
  .layout{ grid-template-columns: 1fr; grid-template-areas: 'controls' 'viz' }
  .controls{ order:2; height:auto }
  #map{ height:60vh }
  .controls .card{ position: static }
  .control-block label{ font-size:14px }
  .chips label{ padding:8px 10px; font-size:13px }
  .range-vals input{ padding:8px 10px; }
  .modal-dialog{ margin: 6vh auto 0; width: 94vw }
}

/* subtle highlight when navigating from map -> card */
@keyframes pulseCard { 
  0% { box-shadow: 0 0 0 0 rgba(83,215,105,0.45); } 
  100% { box-shadow: 0 0 0 14px rgba(83,215,105,0); } 
}
.pulse { animation: pulseCard 0.8s ease-out; }
